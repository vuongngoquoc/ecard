<form name="form1" method="post" action="index.php" enctype='multipart/form-data'>
<input type="hidden" name="step" value="{'step'}" />
<input type="hidden" name="what" value="" />
<h1><img border="0" src="html/07_icon_ban_user2.gif" alt="" style="vertical-align:middle" /> {'ban_user_txt_ban_ip_email'} 
({'ban_user_txt_total'} {'count_total'})</h1>
<div style="border:1px solid silver;padding:4px;cursor:pointer;line-height:20px;background-image: url(html/07_title_background2.gif);font-weight:bold" onclick="showid('show_add_table');"><img border="0" src="html/07_icon_add22.gif" alt="" style="vertical-align:middle" /> {'ban_user_txt_click_here_to_add_new_ip_email_to_ban_list'}</div><br />
<div style="width:100%;display:none" id="show_add_table">	
	<table width="100%" style="background-color:silver" cellspacing="1" cellpadding="4">
		<tr style="background-image: url(html/07_title_background.gif);line-height:17px;font-weight:bold">
			<td width="100%" style="cursor:pointer" onclick="showid('show_add_table');" colspan="2"><div style="float:left;">{'ban_user_txt_add_new_ip_email_ban_list'}</div><img border="0" src="html/07_icon_button_close.gif" title="{'ban_user_tooltip_close_hide'}" alt="{'ban_user_tooltip_close_hide'}" style="vertical-align:middile;float:right;" /></td>
		</tr>
		<tr style="background-color: #EAEAEA;line-height:17px">
			<td width="20%" valign="top">{'ban_user_txt_input_ip_email_instruction'}{'remote_addr'}</td>
			<td width="80%"><textarea name="email_bulk" id="email_bulk" style="width:90%;height:150px"></textarea></td>
		</tr>
		<tr style="background-color: #EAEAEA;line-height:17px">
			<td width="20%" valign="top">{'ban_user_txt_length_of_ban'}</td>
			<td width="80%">
				<div style="float:left"><select size="1" name="time_end" id="time_end" onchange="time_end_value=this.value;if(this.value=='6'){showid2('show_until','block');}else{showid2('show_until','none');}">
				<option value="1">{'ban_user_txt_forever'}</option>
				<option value="2">1 {'ban_user_txt_day'}</option>
				<option value="3">1 {'ban_user_txt_week'}</option>
				<option value="4">1 {'ban_user_txt_month'}</option>
				<option value="5">1 {'ban_user_txt_year'}</option>
				<option value="6">{'ban_user_txt_until_to'}</option>
				</select></div><div id="show_until" style="display:none;cursor:pointer;" onclick="get_cid=-1;ShowDiv(this.id,'view_fullsize_table',0,0);frames['calendar_frame'].location.href='index.php?step=admin_calendar';"><input readonly="readonly" type="text" name="time_end_textbox" id="time_end_textbox" value="MM/DD/YYYY" style="width:100px" /> <img border="0" alt="" style="vertical-align:middle" src="html/07_icon_calendar.gif" /></div>
			</td>
		</tr>
		<tr style="background-color: #EAEAEA;line-height:17px">
			<td width="20%" valign="top">{'ban_user_txt_reason_to_ban'}</td>
			<td width="80%"><input type="text" name="ban_reason" id="ban_reason" style="width:90%" /></td>
		</tr>
		<tr style="background-color: #EAEAEA;line-height:17px">
			<td width="20%"></td>
			<td width="80%"><input type="button" value="{'ban_user_button_submit'}" class="button" onclick="AddNew();" /></td>
		</tr>		
	</table><br />
</div>
<div><strong>{'ban_user_txt_tips'}:</strong></div>
{'ban_user_txt_tips_instruction'}{'show_info'}
<table width="100%" align="center" style="background-color: silver;" cellspacing="1" cellpadding="3">			
	<tr style="line-height:20px;background-image: url(html/07_title_background.gif);font-weight:bold">
		<td width="1%" align="center" style="white-space:nowrap;padding:4px">{'ban_user_txt_column_name_icon'}</td>
		<td width="*"  style="white-space:nowrap;padding:4px">{'ban_user_txt_column_name_ip_email'}</td>
		<td width="20%" align="center" style="white-space:nowrap;padding:4px">{'ban_user_txt_column_name_length_of_ban'}</td>
		<td width="1%" align="center" style="white-space:nowrap;padding:4px">{'ban_user_txt_column_name_unban'}</td>
		<td width="1%" align="center" style="white-space:nowrap;padding:4px"><input onkeypress="return noEnterKey(event);" id="chk_all" title="{'ban_user_tooltip_select_all'}" type="checkbox" value="ON" onclick="check_uncheck_all('{'bk_id'}');" /></td>
	</tr>	
	{'show_list_table'}
	<tr style="line-height:20px;background-image: url(html/07_title_background.gif);">
		<td width="100%" colspan="5">
			<table border="0" width="100%" cellspacing="0" cellpadding="0">
			<tr>
				<td width="33%"><strong>{'ban_user_txt_display_row_per_page'}</strong> <input type="text" name="row_number" size="10" value="{'row_number'}" onkeypress="return isNumberKey(event)" onchange="document.form1.submit();" /></td>
				<td width="33%" align="center" style="white-space:nowrap"><strong>{'ban_user_txt_search_ip_email'}</strong> <input type="text" name="keyword" size="20" value="{'keyword'}" onkeypress="return noEnterKey(event)" /> <input type="submit" value="{'ban_user_button_search'}" class="button" name="cmd_button" /></td>
				<td width="33%" align="right"><input type="button" value="{'ban_user_button_unban_selected'}" class="button" onclick="CheckSelected();" /> <img border="0" src="html/pointer.gif" alt="" style="vertical-align:middle" /></td>
			</tr>
			</table>
		</td>
	</tr>	
</table>
{'display_page_number'}
<div id="view_fullsize_table" style="display:none;position:absolute;top:0;left:0;z-index:9;border:thick solid #FCAA03;width:250px">
	<div style="cursor:pointer;padding:5px;background-image: url(html/07_title_background.gif);font-weight:bold" onclick="HideItAll();" title="{'ban_user_tooltip_click_here_to_close'}">
		<table border="0" width="100%" cellspacing="0" cellpadding="0">
		<tr>
			<td align="left" width="99%">{'ban_user_txt_calendar'}</td>
			<td align="right" width="1%"><img border="0" src="html/07_icon_button_close.gif" title="{'ban_user_tooltip_close_hide'}" alt="{'ban_user_tooltip_close_hide'}" /></td>
		</tr>
		</table>
	 </div>
	<iframe frameborder="0" height="230px" width="100%" scrolling="no" id="calendar_frame" name="calendar_frame" src="" ></iframe>
</div>
</form>
<script type="text/javascript">
var get_cid="";
var myid="{'bk_id'}";
var array=myid.split(",");
var time_end_value="";
function AddNew(){	
	if(document.form1.time_end_textbox.value=="MM/DD/YYYY"){
		document.form1.time_end_textbox.value="";
	}
		
	if(document.form1.email_bulk.value==""){
		alert("{'ban_user_message_list_of_ip_email_required'}");
		document.form1.email_bulk.focus();
	}
	else if(time_end_value=="5" && document.form1.time_end_textbox.value==""){
		alert("{'ban_user_message_length_of_ban_required'}");
		document.form1.time_end_textbox.focus();
	}
	else if(document.form1.ban_reason.value==""){
		alert("{'ban_user_message_reason_to_ban_required'}");
		document.form1.ban_reason.focus();
	}
	else{
		document.form1.what.value='add_new_bulk';
		document.form1.submit();
	}
}

function CheckSelected(){
	if(myid!=""){
		var selected_id="";
		for(i=0;i<=array.length-1;i++){
			if(document.getElementById("bk" + array[i]).checked)
				selected_id += "&mylist_id" + array[i] + "=" + document.getElementById("bk" + array[i]).value ;
		}
		if(selected_id==""){
			alert("{'ban_user_message_checkbox_first_required'}");
		}
		else{
			DeleteSelected();
		}
	}
}

function DeleteSelected(){
	var selected_id="";	
	for(i=0;i<=array.length-1;i++){
		if(document.getElementById("bk" + array[i]).checked)
			selected_id += "&mylist_id" + array[i] + "=" + document.getElementById("bk" + array[i]).value ;
	}

	url="index.php?step={'step'}&what=delete_selected"+selected_id+"&page={'page'}&row_number={'row_number'}";
	if(window.confirm("{'ban_user_message_confirm_to_unban'}")){
		location.href=url;
	}
	else{
		document.getElementById("chk_all").checked=false;
		check_uncheck_all('{'bk_id'}');
	}
}

function ChangeStatus(email,num,data){
	if(data=="1"){//Active
		document.getElementById("icon"+num).src="html/07_icon_no_email.gif";
		document.getElementById("moreinfo"+num).innerHTML="{'ban_user_message_active_server_will_not_send_anything'}";
	}
	else{//Pending
		document.getElementById("icon"+num).src="html/07_icon_yes_email.gif";
		document.getElementById("moreinfo"+num).innerHTML="{'ban_user_message_pending_user_still_receive_ecard_and_email'}";
	}
	Editme('index.php?step=edit_me&table=max_black_list&edit_id=black_email&edit_id_value='+email+'&edit_key=black_active&edit_value=',data,'1',num,"icon"+num);
}

function HideItAll(){
	document.getElementById('view_fullsize_table').style.display="none";
	document.getElementById('hidden_iframe').style.display="none";
}

function InsertDate(id,data){
	if(id=="-1"){
		document.getElementById('time_end_textbox').value=data;
	}
	else{
		document.getElementById('time_end_textbox'+id).value=data;
		Editme('index.php?step={'step'}&what=update_time_end&ban_id='+id+'&time_end_textbox=',data,'1',id,"time_end_textbox"+id);
	}
}

</script>